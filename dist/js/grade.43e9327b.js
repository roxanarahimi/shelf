"use strict";(self["webpackChunkmonitoring"]=self["webpackChunkmonitoring"]||[]).push([[924],{8687:function(e,t,s){s.d(t,{A:function(){return E}});var l=s(6768),o=s(4232);const c={class:"align-self-start text-start bg-light rounded rounded p-3"},r={class:"px-1 mb-4 text-start"},a=["value"],n=(0,l.Lk)("b",null,"استان ",-1),i={class:"d-inline-block"},u=(0,l.Lk)("b",null," شهر ",-1),m={class:"d-inline-block"},d=(0,l.Lk)("br",null,null,-1),p=(0,l.Lk)("b",null," منطقه ",-1),v={class:"d-inline-block"},g=(0,l.Lk)("b",null," مسیر ",-1),k={class:"d-inline-block"},L=(0,l.Lk)("b",null," کد مسیر ",-1),_={class:"d-inline-block"},b={class:"d-flex justify-content-between"},f=(0,l.Lk)("b",null,"تلفن ",-1),y={class:"d-inline-block"},h={key:0},C=(0,l.Lk)("b",null,"گرید ",-1),x={class:"d-inline-block"};function w(e,t,s,w,R,I){return(0,l.uX)(),(0,l.CE)("div",c,[(0,l.Lk)("div",r,[(0,l.Lk)("input",{type:"hidden",id:"customer_id",value:s.customer.id},null,8,a),(0,l.Lk)("p",null,(0,o.v_)(s.customer.name),1),(0,l.Lk)("p",null,(0,o.v_)(s.customer.address),1),n,(0,l.Lk)("p",i,(0,o.v_)(s.customer.province.title),1),u,(0,l.Lk)("p",m,(0,o.v_)(s.customer.city.title),1),d,(0,l.Lk)("div",null,[p,(0,l.Lk)("p",v,(0,o.v_)(s.customer.region.title),1),g,(0,l.Lk)("p",k,(0,o.v_)(s.customer.path),1),L,(0,l.Lk)("p",_,(0,o.v_)(s.customer.path_code),1)]),(0,l.Lk)("div",null,[(0,l.Lk)("p",null,(0,o.v_)(s.customer.path_description),1)]),(0,l.Lk)("div",b,[(0,l.Lk)("div",null,[f,(0,l.Lk)("p",y,[(0,l.eW)((0,o.v_)(s.customer.phone)+" ",1),s.customer.mobile&&s.customer.phone?((0,l.uX)(),(0,l.CE)("span",h,"-")):(0,l.Q3)("",!0),(0,l.eW)(" "+(0,o.v_)(s.customer.mobile),1)])]),(0,l.Lk)("div",null,[C,(0,l.Lk)("p",x,(0,o.v_)(s.customer.scores?.grade),1)])])])])}var R={name:"CustomerInfo",props:["customer"]},I=s(1241);const q=(0,I.A)(R,[["render",w]]);var E=q},1989:function(e,t,s){s.r(t),s.d(t,{default:function(){return we}});var l=s(6768),o=s(4232);const c={class:"d-grid text-start h-100 px-4"},r=(0,l.Lk)("b",{class:"mb-4 text-start d-block"},"گرید بندی فروشگاه",-1),a={class:"row p-0 m-0"},n={class:"col-6 px-1"},i=(0,l.Lk)("label",{for:"meterage"},"متراژ سوپر مارکت",-1),u={class:"form-select form-select-sm",id:"meterage"},m=["selected"],d=["selected"],p=["selected"],v=["selected"],g=["selected"],k={class:"col-6 px-1"},L=(0,l.Lk)("label",{for:"product_variety"},"تنوع محصولات",-1),_={class:"form-select form-select-sm",id:"product_variety"},b=["selected"],f=["selected"],y=["selected"],h=["selected"],C=["selected"],x={class:"col-6 px-1"},w=(0,l.Lk)("label",{for:"product_layout"},"چیدمان محصولات",-1),R={class:"form-select form-select-sm",id:"product_layout"},I=["selected"],q=["selected"],E=["selected"],K=["selected"],A=["selected"],F={class:"col-6 px-1"},X=(0,l.Lk)("label",{for:"equipment"},"تجهیزات سوپر مارکت",-1),S={class:"form-select form-select-sm",id:"equipment"},B=["selected"],Q=["selected"],U=["selected"],P=["selected"],D=["selected"],j={class:"col-12 px-1"},G=(0,l.Lk)("label",{for:"sector_id"},"محله",-1),T={class:"form-select form-select-sm",id:"sector_id"},W=["selected","value"],z={class:"px-1"},H=(0,l.Lk)("label",null,"تصویر سردر سوپر مارکت",-1),M={class:"align-self-end my-2"};function V(e,t,s,V,J,N){const O=(0,l.g2)("customer-info"),Y=(0,l.g2)("image-cropper");return(0,l.uX)(),(0,l.CE)("div",c,[r,V.customer.id?((0,l.uX)(),(0,l.Wv)(O,{key:0,customer:V.customer},null,8,["customer"])):(0,l.Q3)("",!0),(0,l.Lk)("div",a,[(0,l.Lk)("div",n,[i,(0,l.Lk)("select",u,[(0,l.Lk)("option",{selected:V.customer.scores&&1==V.customer.scores.meterage,value:"1"},"کمتر از 12",8,m),(0,l.Lk)("option",{selected:V.customer.scores&&2==V.customer.scores.meterage,value:"2"},"12 تا 25",8,d),(0,l.Lk)("option",{selected:V.customer.scores&&3==V.customer.scores.meterage,value:"3"},"25 تا 45",8,p),(0,l.Lk)("option",{selected:V.customer.scores&&4==V.customer.scores.meterage,value:"4"},"45 تا 60",8,v),(0,l.Lk)("option",{selected:V.customer.scores&&5==V.customer.scores.meterage,value:"5"},"بیش از 60",8,g)])]),(0,l.Lk)("div",k,[L,(0,l.Lk)("select",_,[(0,l.Lk)("option",{selected:V.customer.scores&&1==V.customer.scores.product_variety,value:"1"},"1",8,b),(0,l.Lk)("option",{selected:V.customer.scores&&2==V.customer.scores.product_variety,value:"2"},"2",8,f),(0,l.Lk)("option",{selected:V.customer.scores&&3==V.customer.scores.product_variety,value:"3"},"3",8,y),(0,l.Lk)("option",{selected:V.customer.scores&&4==V.customer.scores.product_variety,value:"4"},"4",8,h),(0,l.Lk)("option",{selected:V.customer.scores&&5==V.customer.scores.product_variety,value:"5"},"5",8,C)])]),(0,l.Lk)("div",x,[w,(0,l.Lk)("select",R,[(0,l.Lk)("option",{selected:V.customer.scores&&1==V.customer.scores.product_layout,value:"1"},"1",8,I),(0,l.Lk)("option",{selected:V.customer.scores&&2==V.customer.scores.product_layout,value:"2"},"2",8,q),(0,l.Lk)("option",{selected:V.customer.scores&&3==V.customer.scores.product_layout,value:"3"},"3",8,E),(0,l.Lk)("option",{selected:V.customer.scores&&4==V.customer.scores.product_layout,value:"4"},"4",8,K),(0,l.Lk)("option",{selected:V.customer.scores&&5==V.customer.scores.product_layout,value:"5"},"5",8,A)])]),(0,l.Lk)("div",F,[X,(0,l.Lk)("select",S,[(0,l.Lk)("option",{selected:V.customer.scores&&1==V.customer.scores.equipment,value:"1"},"1",8,B),(0,l.Lk)("option",{selected:V.customer.scores&&2==V.customer.scores.equipment,value:"2"},"2",8,Q),(0,l.Lk)("option",{selected:V.customer.scores&&3==V.customer.scores.equipment,value:"3"},"3",8,U),(0,l.Lk)("option",{selected:V.customer.scores&&4==V.customer.scores.equipment,value:"4"},"4",8,P),(0,l.Lk)("option",{selected:V.customer.scores&&5==V.customer.scores.equipment,value:"5"},"5",8,D)])]),(0,l.Lk)("div",j,[G,(0,l.Lk)("select",T,[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(V.sectors,(e=>((0,l.uX)(),(0,l.CE)("option",{selected:V.customer.scores&&V.customer.scores.sector.id==e.id,key:e.id,value:e.id},(0,o.v_)(e.title),9,W)))),128))])]),(0,l.Lk)("div",z,[H,(0,l.bF)(Y,{name:"",caption:"",hasCaption:V.hasCaption,isPng:V.isPng,isRequired:V.imgRequired,aspect:V.aspect},null,8,["hasCaption","isPng","isRequired","aspect"])])]),(0,l.Lk)("div",M,[(0,l.Lk)("button",{onClick:t[0]||(t[0]=(...e)=>V.saveScores&&V.saveScores(...e)),class:"btn bg"},"ذخیره")])])}s(4114);var J=s(144),N=s(1893),O=s(1387),Y=s(1877),Z=s(8687),$=s(5130);const ee=["id"],te={key:0,class:"p-1 text-center m-2",style:{"max-width":"265px","min-height":"100px"}},se=["id","src"],le={class:"cropper-wrapper justify-content-center d-flex border rounded p-1 text-center m-md-2",style:{"max-width":"369px","min-height":"190px"}},oe={class:"image-container"},ce=["src"],re={key:1,class:"d-inline-block image-preview_wrapper p-1 text-center m-2",style:{"max-width":"265px","min-height":"180px"}},ae=["id"],ne=(0,l.Lk)("i",{class:"bi bi-upload px-2 fw-bold"},null,-1),ie=[ne],ue=["id"],me=(0,l.Lk)("i",{class:"bi bi-eraser px-2 fw-bold","data-bs-toggle":"tooltip","data-bs-placement":"bottom",title:"پاک کن"},null,-1),de=[me],pe=["id","name"],ve=["id"],ge=["id","value"],ke=["id","value"],Le=["id"];function _e(e,t,s,o,c,r){return(0,l.uX)(),(0,l.CE)("div",{class:"image-cropper row",id:"image-cropper row"+s.name,style:{"min-height":"200px"}},[s.src?((0,l.uX)(),(0,l.CE)("div",te,[(0,l.Lk)("img",{id:"former_image_"+s.name,src:s.src,style:{width:"100%",height:"auto"}},null,8,se)])):(0,l.Q3)("",!0),(0,l.Lk)("div",le,[(0,l.bo)((0,l.Lk)("div",oe,[(0,l.Lk)("img",{class:"img-fluid",style:{width:"360px !important",height:"auto !important"},ref:"image",src:o.imageSrc,alt:""},null,8,ce)],512),[[$.aG,o.selectedFile]])]),!s.hasCaption&&o.selectedFile?((0,l.uX)(),(0,l.CE)("div",re,[(0,l.Lk)("img",{id:"preview_"+s.name,class:"image-preview",style:{width:"100%",height:"auto"},alt:""},null,8,ae)])):(0,l.Q3)("",!0),(0,l.Lk)("div",null,[(0,l.Lk)("span",{onClick:t[0]||(t[0]=e=>o.imageInput.click()),class:"btn btn-primary btn-sm m-1 mb-3","data-bs-toggle":"tooltip","data-bs-placement":"bottom",title:"انتخاب عکس"},ie),(0,l.bo)((0,l.Lk)("span",{id:"btn_clear_image_"+s.name,onClick:t[1]||(t[1]=(...e)=>o.clearFile&&o.clearFile(...e)),class:"btn btn-primary btn-sm m-1 mb-3"},de,8,ue),[[$.aG,o.selectedFile]])]),(0,l.Lk)("input",{id:"image"+s.name,ref:"imageInput",accept:".png",onChange:t[2]||(t[2]=(...e)=>o.fileChanged&&o.fileChanged(...e)),type:"file",name:"content_image_file"+s.name,class:"form-control d-none"},null,40,pe),(0,l.Lk)("input",{id:"Image_"+s.name+"_code",name:"content_image_code",type:"text",class:"form-control image_code_64 d-none"},null,8,ve),o.selectedFile?((0,l.uX)(),(0,l.CE)("input",{key:2,id:"Image_"+s.name+"_name",name:"content_image_name",value:o.selectedFile.name,type:"text",class:"file_name form-control d-none"},null,8,ge)):(0,l.Q3)("",!0),s.isRequired?((0,l.uX)(),(0,l.CE)("input",{key:3,id:"Image_"+s.name,type:"text",value:o.selectedFile,class:"form-control d-none",required:""},null,8,ke)):(0,l.Q3)("",!0),s.isRequired?((0,l.uX)(),(0,l.CE)("div",{key:4,id:"imageHelp"+s.name,class:"form-text error"},null,8,Le)):(0,l.Q3)("",!0)],8,ee)}var be={name:"ImageCropper",events:["imageCropped"],props:["name","isRequired","hasCaption","aspect","src","isPng"],setup(e,{emit:t}){const s=(0,J.KR)(null),o=(0,J.KR)(null),c=(0,J.KR)(null),r=(0,J.KR)(null),a=(0,J.KR)(null);let n=null;const i=new FileReader;i.onload=e=>{c.value=e.target.result};const u=()=>{c.value&&(!0===e.isPng?a.value=n.getCroppedCanvas({fillColor:"transparent"})?.toDataURL("image/png"):a.value=n.getCroppedCanvas({fillColor:"#fff"})?.toDataURL("image/jpeg"),document.getElementById("preview_"+e.name)?.setAttribute("src",a.value),document.getElementById("Image_"+e.name+"_code").setAttribute("value",a.value))},m=()=>{c?(document.addEventListener("click",u),console.log("added"),u()):(document.removeEventListener("click",u),console.log("removed"))},d=t=>{document.removeEventListener("click",u);let s=t.target.files||t.dataTransfer.files;if(s.length&&(o.value=s[0]),"image/png"!=s[0].type&&(o.value=null,alert("فرمت باید png باشد")),s[0],"image/png"==s[0].type){let t=new FileReader;t.onload=function(s){let l=new Image;l.onload=function(){l.width<200&&(o.value=null,document.getElementById("preview_"+e.name).setAttribute("src",""),document.getElementById("Image_"+e.name+"_code").setAttribute("value",""),a.value=null,alert("عرض تصویر باید بیش از 200 پیکسل باشد"))},l.src=t.result},t.readAsDataURL(s[0])}m()},p=()=>{o.value=null,document.getElementById("image"+e.name).value=null,document.getElementById("preview_"+e.name).setAttribute("src",""),document.getElementById("Image_"+e.name+"_code").setAttribute("value",""),"inner"===e.name&&(document.getElementById("Image_"+e.name+"_alt").value="",document.getElementById("Image_"+e.name+"_max_width").value=""),a.value=null};return(0,l.sV)((()=>{n=new Cropper(r.value,{viewMode:3,background:!1,zoomable:!1,scalable:!1,aspectRatio:e.aspect})})),(0,l.hi)((()=>{n.destroy()})),(0,l.nT)((()=>{o.value?i.readAsDataURL(o.value):c.value=null})),(0,l.wB)(c,(async()=>{c.value&&(await n.replace(c.value),setTimeout(await(function(){u()}),200))}),{flush:"post"}),{imageInput:s,selectedFile:o,imageSrc:c,image:r,fileChanged:d,clearFile:p,handleImageCropped:u,check1:m}}},fe=s(1241);const ye=(0,fe.A)(be,[["render",_e]]);var he=ye,Ce={name:"Grade",components:{CustomerInfo:Z.A,ImageCropper:he},setup(){const e=(0,J.KR)([]),t=(0,J.KR)([]),s=(0,J.KR)(!1),o=(0,J.KR)(!1),c=(0,J.KR)(!1),r=(0,J.KR)(!0),a=(0,J.KR)({}),n=(0,J.KR)([]),i=(0,O.lq)(),u=N.A.setup().panelUrl,m=(0,J.KR)({}),d=(0,J.KR)([]),p=()=>{axios.get(u+"customer/"+i.params.id).then((e=>{m.value=e.data})).then((()=>{v()})).catch((e=>{console.error(e)}))},v=()=>{axios.get(u+"sector?city_id="+m.value.city.id).then((e=>{d.value=e.data})).catch((e=>{console.error(e)}))},g=()=>{axios.post(u+"score",{customer_id:m.value.id,sector_id:document.querySelector("#sector_id").value,meterage:document.querySelector("#meterage").value,product_variety:document.querySelector("#product_variety").value,product_layout:document.querySelector("#product_layout").value,equipment:document.querySelector("#equipment").value}).then((e=>{Y.A.push({path:"/customer",query:{code:m.value.code}})})).catch((e=>{console.error(e)}))};return(0,l.KC)((()=>{N.A.setup().checkUser(),p()})),{panelUrl:u,loadSectors:v,sectors:d,customer:m,route:i,findCustomer:p,saveScores:g,image_codes:e,image_names:t,imgRequired:s,hasCaption:o,aspect:c,isPng:r,image:a,images:n}}};const xe=(0,fe.A)(Ce,[["render",V]]);var we=xe}}]);
//# sourceMappingURL=grade.43e9327b.js.map